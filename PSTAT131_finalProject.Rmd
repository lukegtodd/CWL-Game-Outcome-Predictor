---
title: "Final Project"
author: "Luke Todd"
date: "4/4/2022"
output: html_document
---

### Step 1: Load packages
```{r setup, include=FALSE, message = FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(readr)
library(tidyverse)
library(tidymodels)
library(janitor)
library(sqldf)

```

### Step 2: Import raw data into R from Github
```{r, error = FALSE, message = FALSE}

# INFINITE WARFARE
champs2017 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2017-08-13-champs.csv"))


# WORLD WAR II
dallas2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2017-12-10-dallas.csv"))
neworleans2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-01-14-neworleans.csv"))
proleagueStageOne2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-04-08-proleague1.csv"))
atlanta2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-03-11-atlanta.csv"))
birmingham2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-04-01-birmingham.csv"))
proleagueRelegation2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-04-19-relegation.csv"))
seattle2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-04-22-seattle.csv"))
anaheim2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-06-17-anaheim.csv"))
proleagueStageTwo2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-07-29-proleague2.csv"))
champs2018 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2018-08-19-champs.csv"))


# BLACK OPS 4
proleagueQual2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-01-20-proleague-qual.csv"))
proleague2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-07-05-proleague.csv"))
fortworth2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-03-17-fortworth.csv"))
london2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-05-05-london.csv"))
anaheim2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-06-16-anaheim.csv"))
proleagueFinals2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-07-21-proleague-finals.csv"))
champs2019 <- read_csv(url("https://raw.githubusercontent.com/Activision/cwl-data/master/data/data-2019-08-18-champs.csv"))

```

```{r}

champs2017 <- champs2017 %>% clean_names(.)

```



### Step 3: Determine what data is valuable to us
**What data are we concerned with?**
In order to assign an overall score to each individual player, we will need to address Hardpoint, Search and Destroy, and the 3rd Gamemode separately. Once we have an individual score for each of the three gamemodes, we can use these to determine a final score.

#### Infinite Warfare

**Hardpoint:**
1. player -- what player does the data correspond to  
2. mode -- gamemode  
3. win -- 'W' or 'L'; use to find overall player win/loss ratio  
4. k_d -- kill/death ratio; used to show overall impact on the map  
5. assists -- in addition to k/d, assists show overall support on the map; higher assists can indicate better team work  
6. accuracy_percent -- player accuracy for each match  
7. hill_time_s -- hill time measured in seconds  
8. hill_captures -- shows activity on the map (MIGHT INCLUDE)  
9. hill_defends -- shows activity on the map (MIGHT INCLUDE)  
10. multikills -- x2_piece + x3_piece + x4_piece; multikills are often very influential in a match

**Search and Destroy:**
1. player -- what player does the data correspond to  
2. mode -- gamemode  
3. win -- 'W' or 'L'; use to find overall player win/loss ratio  
4. k_d -- kill/death ratio; used to show overall impact on the map  
5. assists -- in addition to k/d, assists show overall support on the map; higher assists can indicate better team work  
6. accuracy_percent -- player accuracy for each match  
7. fb_round_ratio -- 'snd_firstbloods'/'snd_rounds' (NOT INCLUDED IN BASE DATA SET)  
8. bomb_sneak_defuses -- sneak defuses are often in pivotal rounds  
9. bomb_plants -- good indicator of role (MIGHT INCLUDE)  
10. bomb_defuses -- good indicator of role (MIGHT INCLUDE)  
11. multikills -- x2_piece + x3_piece + x4_piece; multikills are often very influential in a match

**Uplink:**
1. player -- what player does the data correspond to  
2. mode -- gamemode  
3. win -- 'W' or 'L'; use to find overall player win/loss ratio  
4. k_d -- kill/death ratio; used to show overall impact on the map  
5. assists -- in addition to k/d, assists show overall support on the map; higher assists can indicate better team work  
6. accuracy_percent -- player accuracy for each match  
7. uplink_dunks --  shows activity on the map (might include)  
8. uplink_throws --  shows activity on the map (might include)  
9. uplink_points --  shows activity on the map  
10. multikills -- x2_piece + x3_piece + x4_piece; multikills are often very influential in a match  


### Attempt 1: Work with champs2017 data; EDA

#### Organize data into work-able datasets
```{r, fig.height = 25, fig.width = 5}

# whole event data, all players and all maps, where player names are organized alphabetically 
champs2017 <- champs2017[order(champs2017$player),]

# two sample player k_d card
accuracy_champs2017 <- sqldf('SELECT player, k_d FROM champs2017 WHERE player == "Accuracy"')
attach_champs2017 <- sqldf('SELECT player, k_d FROM champs2017 WHERE player == "Attach"')

# all player k_d card
allKD_champs2017 <- sqldf('SELECT player, k_d FROM champs2017')

# all necessary player data for Hardpoint
all_hp_champs2017 <- sqldf('SELECT player, win, k_d, assists, accuracy_percent, hill_time_s, hill_captures, hill_defends, multikills FROM champs2017 WHERE mode == "Hardpoint"')
all_hp_champs2017 <- all_hp_champs2017[order(all_hp_champs2017$player),]
all_hpKD_champs2017 <- sqldf('SELECT player, k_d FROM all_hp_champs2017')

# all necessary player data for Search and Destroy
all_snd_champs2017 <- sqldf('SELECT player, win, k_d, assists, accuracy_percent, bomb_sneak_defuses, bomb_plants, bomb_defuses, multikills, snd_rounds, snd_firstbloods FROM champs2017 WHERE mode == "Search & Destroy"')
all_snd_champs2017 <- all_snd_champs2017[order(all_snd_champs2017$player),]
all_sndKD_champs2017 <- sqldf('SELECT player, k_d FROM all_snd_champs2017')

# all necessary player data for Uplink
all_upl_champs2017 <- sqldf('SELECT player, win, k_d, assists, accuracy_percent, uplink_dunks, uplink_throws, uplink_points, multikills FROM champs2017 WHERE mode == "Uplink"')
all_upl_champs2017 <- all_upl_champs2017[order(all_upl_champs2017$player),]

```

#### Try some basic plots:

```{r, fig.height = 25, fig.width = 5}

# boxplot comparing the KD (OVERALL) of each player that played in the event
ggplot(allKD_champs2017, aes(x = reorder(player, k_d, na.rm = TRUE), y = k_d)) + geom_boxplot() + coord_flip() + labs(y = "Kill/death ratio", x = "Player", subtitle = "Player K/D's for COD Champs 2017 (Infinite Warfare), Descending")

# boxplot comparing the KD (HARDPOINT) of each player that played in the event
ggplot(all_hpKD_champs2017, aes(x = reorder(player, k_d, na.rm = TRUE), y = k_d)) + geom_boxplot() + coord_flip() + labs(y = "Kill/death ratio", x = "Player", subtitle = "Player K/D's in HP for COD Champs 2017 (Infinite Warfare), Descending")

# boxplot comparing the KD (SND) of each player that played in the event
ggplot(all_sndKD_champs2017, aes(x = reorder(player, k_d, na.rm = TRUE), y = k_d)) + geom_boxplot() + coord_flip() + labs(y = "Kill/death ratio", x = "Player", subtitle = "Player K/D's in SND for COD Champs 2017 (Infinite Warfare), Descending")

```





















